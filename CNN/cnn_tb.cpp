#include "cnn.h"
#include "cnn.cpp"
#include "conv1.h"
#include "conv2.h"
#include "conv3.h"
#include "conv4.h"
#include "dense1.h"
#include "dense2.h"
#include <iostream>
void cnn(axi_stream &input_stream, axi_stream &output_stream);
int main() {
    // Declare input and output streams
	axi_stream input_stream;
	axi_stream output_stream;

    // Example input (random or test data)
    float test_input[30][30][3] =  {
    	    {{61, 71, 60}, {62, 80, 89}, {64, 81, 92}, {69, 86, 93}, {67, 74, 75}, {84, 80, 81}, {66, 73, 77}, {35, 40, 52}, {37, 36, 43}, {38, 36, 39}, {86, 51, 46}, {189, 144, 107}, {192, 175, 145}, {160, 149, 134}, {131, 126, 114}, {97, 95, 91}, {60, 63, 64}, {39, 41, 45}, {36, 36, 42}, {36, 35, 44}, {35, 35, 45}, {36, 35, 43}, {37, 36, 40}, {40, 39, 41}, {48, 47, 48}, {54, 54, 64}, {63, 61, 76}, {67, 64, 79}, {67, 65, 72}, {68, 69, 74}},
    	    {{58, 69, 61}, {64, 82, 96}, {62, 80, 94}, {67, 85, 93}, {65, 73, 78}, {85, 80, 77}, {69, 77, 75}, {37, 42, 56}, {36, 35, 45}, {38, 36, 42}, {81, 49, 46}, {184, 140, 103}, {197, 177, 143}, {166, 155, 135}, {133, 128, 118}, {96, 96, 91}, {59, 63, 64}, {36, 39, 45}, {37, 37, 47}, {38, 37, 52}, {37, 36, 54}, {38, 36, 43}, {40, 39, 45}, {44, 43, 54}, {49, 48, 68}, {52, 51, 62}, {57, 55, 61}, {64, 63, 74}, {71, 69, 93}, {68, 68, 87}},
    	    {{58, 69, 57}, {65, 83, 91}, {63, 81, 94}, {62, 82, 92}, {63, 73, 77}, {90, 86, 86}, {75, 82, 83}, {42, 46, 56}, {36, 36, 43}, {35, 36, 39}, {77, 49, 47}, {169, 131, 113}, {194, 172, 150}, {168, 158, 137}, {134, 131, 122}, {97, 99, 95}, {56, 65, 66}, {35, 42, 46}, {36, 39, 45}, {37, 38, 48}, {40, 39, 51}, {40, 39, 44}, {41, 39, 42}, {44, 41, 45}, {46, 43, 55}, {55, 53, 69}, {58, 59, 74}, {64, 64, 69}, {69, 67, 76}, {70, 69, 78}},
    	    {{58, 72, 57}, {63, 82, 87}, {61, 81, 92}, {63, 83, 93}, {65, 76, 79}, {83, 82, 83}, {69, 71, 74}, {45, 46, 56}, {39, 40, 49}, {39, 42, 44}, {70, 60, 55}, {158, 136, 149}, {197, 171, 180}, {183, 174, 174}, {157, 158, 168}, {120, 130, 141}, {78, 109, 125}, {43, 66, 95}, {45, 51, 78}, {40, 44, 64}, {38, 40, 52}, {37, 38, 48}, {41, 39, 42}, {45, 41, 40}, {48, 45, 46}, {53, 52, 64}, {58, 57, 75}, {66, 64, 76}, {70, 67, 70}, {72, 69, 70}},
    	    {{57, 69, 54}, {63, 81, 88}, {64, 81, 93}, {64, 82, 91}, {67, 75, 77}, {81, 76, 76}, {71, 72, 75}, {45, 49, 61}, {47, 47, 58}, {85, 70, 77}, {138, 132, 139}, {140, 137, 193}, {179, 167, 226}, {151, 146, 194}, {142, 143, 194}, {153, 158, 203}, {156, 163, 215}, {160, 156, 237}, {149, 139, 207}, {82, 97, 146}, {52, 67, 94}, {38, 46, 67}, {40, 40, 49}, {43, 41, 40}, {47, 44, 42}, {52, 50, 53}, {60, 59, 70}, {68, 66, 90}, {73, 69, 81}, {74, 68, 71}},
    	    {{56, 66, 54}, {66, 82, 90}, {65, 80, 94}, {66, 82, 94}, {67, 75, 79}, {78, 73, 76}, {66, 69, 72}, {54, 51, 58}, {84, 74, 67}, {160, 148, 178}, {141, 142, 239}, {91, 97, 204}, {79, 76, 187}, {72, 71, 182}, {69, 69, 185}, {74, 76, 191}, {81, 78, 194}, {99, 87, 207}, {120, 110, 206}, {123, 146, 225}, {133, 139, 206}, {108, 105, 149}, {36, 50, 70}, {41, 45, 48}, {50, 49, 58}, {59, 57, 69}, {59, 58, 69}, {69, 67, 69}, {80, 75, 94}, {79, 73, 93}},
    	    {{55, 62, 53}, {70, 83, 92}, {65, 79, 91}, {65, 83, 92}, {66, 76, 81}, {86, 82, 93}, {76, 79, 84}, {87, 75, 58}, {166, 145, 178}, {121, 134, 219}, {78, 90, 219}, {68, 73, 196}, {73, 71, 189}, {72, 74, 189}, {72, 75, 193}, {72, 75, 197}, {66, 73, 197}, {64, 70, 196}, {59, 68, 188}, {68, 91, 205}, {117, 100, 203}, {170, 145, 220}, {104, 129, 185}, {54, 67, 105}, {48, 51, 64}, {55, 51, 63}, {58, 56, 68}, {68, 64, 73}, {81, 76, 85}, {77, 75, 84}},
    	    {{53, 60, 51}, {67, 80, 88}, {63, 77, 88}, {67, 84, 91}, {67, 76, 80}, {91, 85, 91}, {102, 98, 108}, {150, 152, 168}, {122, 130, 214}, {90, 100, 216}, {87, 95, 212}, {119, 120, 209}, {162, 147, 222}, {179, 181, 242}, {180, 190, 243}, {161, 174, 242}, {122, 142, 223}, {85, 102, 195}, {71, 81, 192}, {60, 70, 191}, {66, 69, 192}, {99, 85, 189}, {184, 138, 225}, {130, 139, 204}, {53, 72, 102}, {56, 54, 68}, {56, 57, 65}, {60, 59, 72}, {71, 67, 76}, {74, 73, 78}},
    	    {{49, 58, 50}, {63, 78, 84}, {62, 78, 87}, {65, 83, 91}, {67, 77, 80}, {96, 88, 79}, {143, 133, 151}, {125, 124, 224}, {96, 101, 219}, {126, 115, 222}, {198, 197, 255}, {242, 242, 255}, {255, 255, 255}, {253, 255, 255}, {251, 255, 255}, {250, 255, 255}, {247, 255, 255}, {221, 225, 255}, {171, 176, 236}, {78, 112, 206}, {56, 75, 196}, {70, 70, 195}, {93, 77, 182}, {149, 135, 217}, {133, 130, 192}, {55, 64, 87}, {58, 59, 62}, {66, 65, 76}, {71, 70, 84}, {74, 74, 84}},
    	    {{49, 59, 54}, {63, 79, 93}, {62, 78, 93}, {65, 85, 95}, {68, 77, 85}, {111, 101, 93}, {150, 144, 168}, {116, 113, 234}, {124, 118, 203}, {226, 219, 247}, {255, 255, 255}, {255, 255, 255}, {255, 255, 255}, {255, 255, 255}, {255, 255, 255}, {255, 255, 255}, {255, 255, 255}, {255, 255, 255}, {246, 250, 255}, {204, 234, 252}, {109, 136, 221}, {59, 78, 195}, {61, 69, 191}, {101, 90, 197}, {143, 140, 218}, {82, 103, 144}, {62, 65, 81}, {67, 66, 75}, {71, 71, 76}, {75, 75, 80}},
    	    {{52, 62, 61}, {64, 79, 93}, {60, 77, 89}, {65, 86, 93}, {70, 78, 84}, {135, 122, 136}, {127, 134, 187}, {105, 101, 232}, {201, 184, 237}, {253, 247, 255}, {248, 252, 243}, {250, 252, 234}, {255, 255, 244}, {255, 255, 253}, {255, 255, 255}, {251, 253, 254}, {234, 235, 234}, {225, 226, 192}, {228, 226, 173}, {252, 244, 220}, {209, 231, 248}, {99, 131, 208}, {64, 73, 182}, {63, 77, 196}, {105, 124, 208}, {116, 138, 203}, {71, 75, 114}, {64, 62, 65}, {72, 71, 75}, {76, 76, 80}},
    	    {{51, 59, 58}, {65, 80, 90}, {61, 77, 87}, {64, 83, 88}, {81, 84, 85}, {159, 139, 182}, {115, 115, 199}, {125, 110, 222}, {247, 224, 254}, {193, 206, 210}, {109, 140, 123}, {151, 162, 130}, {254, 206, 179}, {255, 255, 242}, {252, 255, 254}, {187, 196, 197}, {109, 118, 109}, {80, 82, 43}, {87, 76, 28}, {181, 145, 100}, {248, 228, 200}, {202, 203, 238}, {79, 96, 187}, {60, 68, 189}, {89, 81, 181}, {168, 144, 227}, {99, 98, 148}, {62, 62, 59}, {74, 70, 71}, {80, 77, 78}},
    	    {{48, 55, 49}, {64, 79, 87}, {64, 79, 90}, {68, 85, 90}, {86, 100, 90}, {145, 152, 218}, {107, 104, 207}, {184, 179, 248}, {226, 229, 247}, {123, 135, 156}, {97, 117, 102}, {87, 95, 69}, {138, 108, 69}, {221, 211, 176}, {229, 236, 246}, {108, 124, 105}, {130, 110, 77}, {201, 183, 172}, {182, 155, 173}, {82, 71, 50}, {175, 161, 74}, {236, 237, 237}, {103, 138, 210}, {63, 74, 193}, {82, 69, 194}, {146, 118, 207}, {113, 120, 165}, {63, 69, 66}, {70, 65, 61}, {75, 75, 73}},
    	    {{46, 55, 51}, {66, 81, 91}, {66, 79, 90}, {73, 86, 87}, {103, 117, 95}, {131, 144, 196}, {123, 107, 192}, {223, 215, 253}, {227, 235, 236}, {205, 212, 219}, {236, 235, 246}, {182, 178, 216}, {79, 69, 51}, {205, 199, 125}, {215, 220, 234}, {73, 88, 71}, {189, 161, 125}, {255, 255, 243}, {237, 227, 246}, {100, 112, 118}, {123, 110, 66}, {249, 237, 222}, {160, 201, 249}, {73, 87, 197}, {70, 66, 193}, {105, 96, 181}, {119, 137, 183}, {82, 93, 114}, {71, 68, 69}, {78, 78, 75}},
    	    {{44, 54, 54}, {67, 82, 94}, {68, 81, 94}, {83, 89, 95}, {131, 133, 113}, {122, 118, 183}, {157, 119, 210}, {255, 255, 255}, {255, 255, 255}, {255, 255, 255}, {247, 240, 254}, {202, 175, 219}, {81, 71, 51}, {200, 194, 129}, {213, 216, 231}, {75, 83, 64}, {196, 172, 134}, {255, 255, 247}, {243, 248, 255}, {106, 127, 129}, {119, 100, 71}, {252, 233, 216}, {199, 234, 255}, {94, 108, 198}, {56, 65, 192}, {85, 102, 193}, {110, 138, 190}, {69, 83, 109}, {71, 69, 81}, {73, 72, 74}},
    	    {{46, 52, 50}, {68, 81, 91}, {67, 81, 96}, {95, 91, 100}, {146, 144, 127}, {106, 110, 185}, {173, 125, 222}, {255, 255, 255}, {255, 255, 255}, {255, 255, 255}, {170, 192, 210}, {89, 111, 116}, {139, 126, 94}, {235, 230, 186}, {215, 220, 240}, {77, 84, 66}, {195, 169, 132}, {255, 255, 247}, {243, 248, 252}, {108, 131, 129}, {111, 97, 74}, {248, 231, 212}, {221, 249, 255}, {107, 120, 202}, {63, 66, 192}, {77, 79, 172}, {108, 135, 189}, {71, 87, 113}, {70, 69, 84}, {73, 69, 73}},
    	    {{45, 51, 47}, {67, 79, 86}, {68, 81, 93}, {99, 94, 102}, {146, 143, 131}, {99, 103, 180}, {181, 129, 227}, {255, 255, 255}, {255, 255, 255}, {255, 255, 255}, {183, 205, 202}, {71, 95, 71}, {102, 96, 58}, {208, 204, 173}, {221, 223, 247}, {80, 88, 74}, {191, 163, 128}, {255, 255, 241}, {245, 250, 251}, {110, 135, 132}, {107, 93, 73}, {246, 229, 207}, {221, 249, 255}, {101, 112, 202}, {65, 65, 190}, {83, 80, 172}, {112, 133, 186}, {86, 98, 120}, {73, 71, 82}, {77, 74, 77}},
    	    {{46, 52, 60}, {66, 78, 91}, {65, 78, 91}, {100, 95, 103}, {148, 145, 134}, {96, 98, 178}, {175, 123, 221}, {255, 255, 255}, {255, 255, 255}, {255, 255, 255}, {240, 251, 252}, {168, 182, 224}, {74, 74, 70}, {184, 173, 118}, {225, 224, 240}, {77, 91, 78}, {190, 158, 125}, {255, 255, 236}, {245, 250, 251}, {116, 140, 138}, {107, 91, 72}, {243, 225, 199}, {197, 228, 252}, {96, 108, 199}, {66, 64, 188}, {91, 83, 174}, {115, 131, 183}, {66, 76, 94}, {74, 71, 88}, {79, 76, 87}},
    	    {{48, 55, 58}, {67, 80, 93}, {65, 81, 95}, {96, 93, 99}, {148, 145, 130}, {97, 100, 178}, {158, 110, 213}, {255, 251, 255}, {251, 254, 234}, {253, 250, 231}, {255, 253, 253}, {226, 226, 252}, {74, 75, 73}, {167, 153, 93}, {229, 230, 231}, {78, 105, 92}, {165, 131, 110}, {243, 237, 232}, {237, 234, 251}, {101, 118, 122}, {118, 102, 60}, {244, 226, 207}, {155, 189, 233}, {71, 85, 191}, {68, 62, 186}, {112, 96, 185}, {112, 124, 171}, {59, 68, 76}, {69, 67, 73}, {76, 73, 78}},
    	    {{44, 53, 52}, {65, 80, 92}, {63, 80, 94}, {81, 88, 93}, {127, 135, 114}, {96, 107, 182}, {126, 96, 206}, {231, 227, 255}, {196, 217, 211}, {192, 168, 158}, {233, 210, 201}, {165, 154, 166}, {84, 90, 70}, {191, 183, 133}, {233, 249, 243}, {99, 151, 154}, {92, 94, 95}, {150, 130, 124}, {139, 122, 128}, {84, 97, 89}, {158, 144, 104}, {234, 219, 224}, {112, 140, 207}, {61, 70, 186}, {74, 63, 182}, {138, 113, 197}, {109, 111, 157}, {66, 71, 80}, {64, 63, 66}, {66, 67, 68}},
    	    {{45, 53, 52}, {63, 77, 87}, {62, 75, 88}, {69, 82, 87}, {104, 120, 96}, {101, 119, 188}, {91, 85, 201}, {172, 163, 238}, {232, 232, 255}, {99, 118, 139}, {68, 76, 49}, {99, 92, 54}, {151, 128, 89}, {237, 232, 201}, {247, 255, 251}, {216, 238, 249}, {126, 132, 154}, {88, 86, 65}, {101, 96, 60}, {145, 137, 106}, {217, 209, 202}, {186, 185, 231}, {74, 91, 182}, {58, 65, 181}, {83, 80, 186}, {138, 126, 198}, {92, 91, 132}, {65, 66, 86}, {66, 66, 75}, {69, 68, 72}},
    	    {{47, 53, 53}, {61, 73, 83}, {58, 70, 80}, {65, 80, 84}, {88, 101, 91}, {124, 132, 197}, {84, 88, 204}, {119, 108, 225}, {226, 212, 255}, {209, 233, 242}, {183, 200, 207}, {207, 205, 200}, {249, 239, 232}, {255, 255, 251}, {255, 255, 254}, {255, 255, 255}, {238, 241, 240}, {223, 228, 218}, {230, 233, 219}, {248, 243, 238}, {201, 201, 239}, {113, 124, 204}, {59, 69, 176}, {66, 65, 180}, {105, 103, 189}, {113, 119, 155}, {75, 74, 81}, {62, 62, 70}, {65, 65, 78}, {70, 68, 79}},
    	    {{48, 54, 51}, {61, 74, 85}, {60, 73, 84}, {65, 80, 87}, {80, 81, 85}, {146, 129, 168}, {97, 101, 183}, {80, 79, 209}, {177, 163, 232}, {248, 234, 253}, {255, 253, 255}, {255, 255, 255}, {255, 255, 255}, {255, 255, 255}, {255, 255, 254}, {255, 255, 254}, {255, 255, 252}, {255, 255, 247}, {249, 250, 253}, {208, 201, 237}, {126, 134, 206}, {65, 80, 181}, {56, 64, 170}, {98, 86, 183}, {130, 126, 202}, {71, 90, 127}, {59, 62, 76}, {66, 65, 83}, {69, 68, 77}, {78, 72, 76}},
    	    {{46, 52, 48}, {61, 73, 86}, {60, 73, 87}, {67, 80, 91}, {77, 76, 88}, {139, 120, 131}, {118, 129, 173}, {72, 82, 205}, {90, 84, 183}, {183, 154, 220}, {248, 226, 255}, {255, 249, 255}, {255, 255, 255}, {255, 255, 255}, {255, 255, 254}, {255, 255, 255}, {255, 251, 254}, {242, 242, 253}, {169, 179, 225}, {104, 119, 194}, {68, 78, 176}, {59, 65, 171}, {80, 85, 183}, {117, 117, 195}, {90, 90, 136}, {57, 62, 87}, {55, 57, 73}, {59, 58, 78}, {65, 62, 68}, {75, 70, 70}},
    	    {{43, 49, 46}, {60, 71, 85}, {58, 70, 86}, {65, 78, 91}, {71, 75, 90}, {108, 95, 88}, {157, 139, 153}, {118, 115, 209}, {69, 77, 194}, {78, 70, 186}, {117, 110, 205}, {162, 154, 224}, {221, 208, 238}, {228, 217, 232}, {225, 216, 231}, {208, 204, 230}, {173, 169, 215}, {124, 125, 200}, {79, 86, 183}, {58, 68, 177}, {60, 66, 178}, {87, 88, 183}, {124, 118, 199}, {92, 93, 150}, {62, 65, 66}, {49, 50, 50}, {51, 55, 62}, {64, 65, 76}, {65, 62, 66}, {75, 68, 70}},
    	    {{51, 57, 54}, {60, 70, 82}, {61, 71, 84}, {65, 78, 90}, {67, 75, 91}, {90, 84, 82}, {131, 111, 107}, {134, 122, 143}, {105, 109, 188}, {65, 74, 188}, {61, 67, 194}, {74, 73, 193}, {93, 82, 194}, {102, 90, 195}, {99, 91, 197}, {89, 87, 184}, {79, 80, 179}, {67, 69, 185}, {60, 65, 182}, {59, 63, 169}, {89, 95, 181}, {117, 121, 193}, {95, 92, 128}, {60, 63, 68}, {46, 50, 54}, {51, 52, 60}, {55, 57, 67}, {67, 67, 76}, {68, 66, 72}, {78, 72, 75}},
    	    {{41, 47, 46}, {59, 69, 81}, {60, 69, 82}, {65, 76, 88}, {67, 75, 91}, {83, 82, 88}, {94, 97, 97}, {122, 114, 116}, {155, 142, 168}, {115, 128, 169}, {94, 103, 152}, {100, 105, 152}, {100, 105, 146}, {104, 105, 142}, {101, 103, 140}, {92, 99, 135}, {92, 97, 133}, {94, 99, 138}, {94, 97, 136}, {102, 107, 139}, {121, 126, 149}, {118, 127, 150}, {77, 95, 111}, {50, 56, 64}, {45, 46, 47}, {50, 51, 59}, {58, 56, 68}, {64, 64, 73}, {70, 71, 86}, {72, 71, 80}},
    	    {{43, 48, 49}, {57, 67, 80}, {57, 67, 80}, {65, 75, 87}, {69, 74, 92}, {83, 80, 88}, {116, 109, 107}, {161, 158, 145}, {197, 197, 192}, {212, 214, 213}, {221, 222, 222}, {218, 221, 221}, {191, 197, 193}, {214, 207, 199}, {220, 219, 211}, {192, 205, 199}, {201, 198, 190}, {210, 205, 191}, {206, 205, 191}, {204, 202, 189}, {215, 196, 183}, {204, 189, 187}, {129, 152, 160}, {75, 80, 94}, {49, 47, 49}, {54, 53, 57}, {60, 58, 65}, {63, 63, 68}, {66, 67, 81}, {68, 67, 77}},
    	    {{46, 48, 50}, {60, 66, 79}, {57, 65, 77}, {69, 74, 86}, {74, 75, 96}, {87, 79, 84}, {135, 126, 111}, {215, 207, 174}, {255, 253, 236}, {255, 255, 249}, {255, 255, 255}, {254, 255, 255}, {253, 255, 255}, {255, 255, 254}, {255, 255, 251}, {250, 255, 251}, {251, 251, 240}, {249, 246, 217}, {254, 249, 227}, {245, 245, 225}, {251, 239, 219}, {239, 231, 228}, {154, 175, 181}, {81, 87, 97}, {49, 47, 57}, {51, 49, 54}, {57, 54, 56}, {61, 60, 59}, {65, 64, 67}, {67, 67, 72}},
    	    {{46, 46, 52}, {61, 66, 79}, {57, 66, 78}, {68, 75, 85}, {76, 77, 95}, {88, 78, 74}, {144, 127, 97}, {239, 228, 171}, {235, 232, 166}, {252, 252, 210}, {255, 255, 255}, {255, 255, 255}, {255, 255, 255}, {255, 255, 248}, {242, 234, 204}, {216, 207, 181}, {197, 189, 152}, {200, 185, 111}, {238, 222, 180}, {194, 207, 169}, {207, 197, 151}, {244, 231, 212}, {154, 175, 174}, {83, 89, 99}, {49, 49, 60}, {51, 48, 59}, {57, 55, 63}, {60, 57, 61}, {70, 66, 72}, {70, 70, 75}}
    	};

    // Feed input into the stream
    for (int i = 0; i < 30; i++) {
        for (int j = 0; j < 30; j++) {
            for (int c = 0; c < 3; c++) {
                axi_t val;
                val.data = test_input[i][j][c];
                input_stream.write(val);
            }
        }
    }

    // Call the CNN forward function
    cnn(input_stream, output_stream);

    // Retrieve and print the output
    float output[43];
    for (int i = 0; i < 43; i++) {
        axi_t val = output_stream.read();
        output[i] = val.data;
        std::cout << "Output[" << i << "] = " << output[i] << std::endl;
    }

    return 0;
}
