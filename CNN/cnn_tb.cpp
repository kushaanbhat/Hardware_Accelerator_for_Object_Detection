#include "cnn.h"
#include <iostream>
void cnn(axi_stream &input_stream, axi_stream &output_stream);
int main() {
    // Declare input and output streams
	axi_stream input_stream;
	axi_stream output_stream;

    // Example input (random or test data)
    float test_input[30][30][3] =  {
    		{{131, 201, 243}, {131, 201, 243}, {131, 201, 243}, {131, 201, 243}, {131, 201, 243}, {131, 201, 243}, {131, 201, 243}, {131, 201, 243}, {131, 201, 243}, {131, 201, 243}, {131, 201, 243}, {131, 201, 243}, {131, 201, 243}, {131, 201, 243}, {131, 201, 243}, {131, 201, 243}, {131, 201, 243}, {131, 201, 243}, {131, 201, 243}, {131, 201, 243}, {131, 201, 243}, {131, 201, 243}, {131, 201, 243}, {131, 201, 243}, {131, 201, 243}, {131, 201, 243}, {131, 201, 243}, {131, 201, 243}, {131, 201, 243}, {131, 201, 243}},
    		{{133, 201, 243}, {133, 201, 243}, {133, 201, 243}, {133, 201, 243}, {133, 201, 243}, {133, 201, 243}, {133, 201, 243}, {133, 201, 243}, {133, 201, 243}, {133, 201, 243}, {133, 201, 243}, {133, 201, 243}, {133, 201, 243}, {133, 201, 243}, {133, 201, 243}, {133, 201, 243}, {133, 201, 243}, {133, 201, 243}, {133, 201, 243}, {133, 201, 243}, {133, 201, 243}, {133, 201, 243}, {133, 201, 243}, {133, 201, 243}, {133, 201, 243}, {133, 201, 243}, {133, 201, 243}, {133, 201, 243}, {133, 201, 243}, {133, 201, 243}},
    		{{138, 203, 242}, {138, 203, 242}, {138, 203, 242}, {138, 203, 242}, {138, 203, 242}, {138, 203, 242}, {138, 203, 242}, {138, 203, 242}, {138, 203, 242}, {138, 203, 242}, {138, 203, 242}, {138, 203, 242}, {138, 203, 242}, {138, 203, 242}, {138, 203, 242}, {138, 203, 242}, {138, 203, 242}, {138, 203, 242}, {138, 203, 242}, {138, 203, 242}, {138, 203, 242}, {138, 203, 242}, {138, 203, 242}, {138, 203, 242}, {138, 203, 242}, {138, 203, 242}, {138, 203, 242}, {138, 203, 242}, {138, 203, 242}, {138, 203, 242}},
    		{{142, 205, 243}, {142, 205, 243}, {142, 205, 243}, {142, 205, 243}, {142, 205, 243}, {142, 205, 243}, {142, 205, 243}, {142, 205, 243}, {142, 205, 243}, {142, 205, 243}, {142, 205, 243}, {142, 205, 243}, {142, 205, 243}, {141, 205, 243}, {141, 205, 243}, {141, 205, 243}, {141, 205, 243}, {142, 205, 243}, {142, 205, 243}, {142, 205, 243}, {142, 205, 243}, {142, 205, 243}, {142, 205, 243}, {142, 205, 243}, {142, 205, 243}, {142, 205, 243}, {142, 205, 243}, {142, 205, 243}, {142, 205, 243}, {142, 205, 243}},
    		{{146, 207, 245}, {146, 207, 245}, {146, 207, 245}, {146, 207, 245}, {146, 207, 245}, {146, 207, 245}, {146, 207, 245}, {146, 207, 245}, {146, 207, 245}, {146, 207, 245}, {146, 207, 245}, {145, 207, 245}, {143, 206, 245}, {146, 212, 249}, {154, 217, 252}, {154, 217, 252}, {146, 211, 249}, {143, 206, 246}, {145, 207, 245}, {146, 207, 245}, {146, 207, 245}, {146, 207, 245}, {146, 207, 245}, {146, 207, 245}, {146, 207, 245}, {146, 207, 245}, {146, 207, 245}, {146, 207, 245}, {146, 207, 245}, {146, 207, 245}},
    		{{151, 209, 246}, {151, 209, 246}, {151, 209, 246}, {151, 209, 246}, {151, 209, 246}, {151, 209, 246}, {151, 209, 246}, {151, 209, 246}, {151, 209, 246}, {151, 209, 246}, {150, 208, 246}, {153, 214, 250}, {188, 224, 244}, {216, 200, 203}, {223, 172, 169}, {224, 172, 168}, {217, 199, 202}, {188, 224, 243}, {153, 214, 250}, {150, 209, 246}, {151, 209, 246}, {151, 209, 246}, {151, 209, 246}, {151, 209, 246}, {151, 209, 246}, {151, 209, 246}, {151, 209, 246}, {151, 209, 246}, {151, 209, 246}, {151, 209, 246}},
    		{{155, 210, 245}, {155, 210, 245}, {155, 210, 245}, {155, 210, 245}, {155, 210, 245}, {155, 210, 245}, {155, 210, 245}, {155, 210, 245}, {155, 210, 245}, {153, 210, 245}, {163, 219, 252}, {215, 206, 211}, {222, 112, 102}, {209, 65, 55}, {206, 56, 46}, {206, 56, 45}, {209, 64, 51}, {222, 111, 97}, {215, 204, 209}, {163, 219, 251}, {153, 210, 245}, {155, 210, 245}, {155, 210, 245}, {155, 210, 245}, {155, 210, 245}, {155, 210, 245}, {155, 210, 245}, {155, 210, 245}, {155, 210, 245}, {155, 210, 245}},
    		{{158, 212, 245}, {158, 212, 245}, {158, 212, 245}, {158, 212, 245}, {158, 212, 245}, {158, 212, 245}, {158, 212, 245}, {158, 212, 245}, {157, 211, 245}, {162, 218, 251}, {217, 200, 203}, {215, 78, 66}, {206, 53, 41}, {207, 60, 47}, {211, 78, 65}, {210, 77, 64}, {206, 58, 44}, {205, 50, 35}, {214, 75, 59}, {214, 197, 199}, {162, 219, 251}, {158, 211, 245}, {158, 212, 245}, {158, 212, 245}, {158, 212, 245}, {158, 212, 245}, {158, 212, 245}, {158, 212, 245}, {158, 212, 245}, {158, 212, 245}},
    		{{161, 214, 246}, {161, 214, 246}, {161, 214, 246}, {161, 214, 246}, {161, 214, 246}, {161, 214, 246}, {161, 214, 246}, {161, 214, 245}, {159, 215, 248}, {203, 218, 230}, {217, 90, 78}, {205, 53, 40}, {215, 96, 84}, {238, 193, 183}, {249, 234, 226}, {247, 233, 226}, {235, 191, 182}, {213, 93, 80}, {204, 48, 33}, {215, 84, 71}, {192, 209, 222}, {158, 215, 248}, {161, 214, 245}, {161, 214, 246}, {161, 214, 246}, {161, 214, 246}, {161, 214, 246}, {161, 214, 246}, {161, 214, 246}, {161, 214, 246}},
    		{{166, 215, 247}, {166, 215, 247}, {166, 215, 247}, {166, 215, 247}, {166, 215, 247}, {166, 215, 247}, {166, 215, 247}, {164, 214, 247}, {177, 226, 253}, {221, 147, 139}, {205, 50, 36}, {218, 104, 92}, {255, 244, 236}, {255, 255, 255}, {255, 255, 248}, {248, 250, 242}, {254, 255, 254}, {248, 239, 234}, {214, 97, 86}, {205, 45, 30}, {210, 135, 129}, {170, 220, 249}, {165, 215, 247}, {166, 215, 247}, {166, 215, 247}, {166, 215, 247}, {166, 215, 247}, {166, 215, 247}, {166, 215, 247}, {166, 215, 247}},
    		{{168, 216, 247}, {168, 216, 247}, {168, 216, 247}, {168, 216, 247}, {168, 216, 247}, {168, 216, 247}, {168, 216, 247}, {165, 217, 250}, {201, 217, 230}, {214, 79, 65}, {211, 67, 54}, {215, 187, 181}, {172, 176, 173}, {167, 167, 162}, {192, 193, 187}, {249, 249, 244}, {184, 185, 181}, {180, 187, 183}, {235, 209, 204}, {205, 59, 46}, {208, 71, 59}, {187, 205, 221}, {166, 218, 250}, {168, 216, 247}, {168, 216, 247}, {168, 216, 247}, {168, 216, 247}, {168, 216, 247}, {168, 216, 247}, {168, 216, 247}},
    		{{172, 218, 248}, {172, 218, 248}, {172, 218, 248}, {172, 218, 248}, {172, 218, 248}, {172, 218, 248}, {172, 218, 248}, {173, 223, 254}, {216, 182, 182}, {207, 50, 34}, {230, 135, 123}, {160, 166, 161}, {29, 31, 30}, {54, 55, 54}, {121, 122, 120}, {181, 182, 179}, {39, 41, 40}, {39, 40, 40}, {163, 170, 169}, {221, 125, 117}, {201, 44, 31}, {199, 169, 173}, {171, 222, 254}, {172, 218, 248}, {172, 218, 248}, {172, 218, 248}, {172, 218, 248}, {172, 218, 248}, {172, 218, 248}, {172, 218, 248}},
    		{{174, 219, 246}, {174, 219, 246}, {174, 219, 246}, {174, 219, 246}, {174, 219, 246}, {174, 219, 246}, {173, 219, 246}, {180, 228, 253}, {218, 146, 139}, {205, 47, 31}, {240, 190, 181}, {153, 160, 156}, {144, 145, 142}, {249, 250, 245}, {253, 254, 250}, {104, 105, 104}, {164, 165, 164}, {177, 178, 176}, {94, 101, 100}, {229, 180, 175}, {197, 42, 30}, {202, 134, 131}, {175, 224, 250}, {174, 219, 246}, {174, 219, 246}, {174, 219, 246}, {174, 219, 246}, {174, 219, 246}, {174, 219, 246}, {174, 219, 246}},
    		{{178, 220, 248}, {178, 220, 248}, {178, 220, 248}, {178, 220, 248}, {178, 220, 248}, {178, 220, 248}, {177, 220, 248}, {188, 229, 253}, {217, 123, 113}, {206, 53, 40}, {244, 217, 210}, {156, 161, 158}, {41, 42, 41}, {54, 56, 55}, {191, 192, 190}, {106, 106, 105}, {180, 181, 179}, {191, 193, 191}, {92, 97, 97}, {230, 205, 202}, {197, 50, 38}, {201, 113, 107}, {181, 224, 249}, {178, 220, 249}, {178, 220, 248}, {178, 220, 248}, {178, 220, 248}, {178, 220, 248}, {178, 220, 248}, {178, 220, 248}},
    		{{181, 221, 247}, {181, 221, 247}, {181, 221, 247}, {181, 221, 247}, {181, 221, 247}, {181, 221, 247}, {180, 221, 247}, {192, 230, 252}, {216, 115, 106}, {206, 57, 43}, {241, 220, 215}, {170, 173, 171}, {103, 104, 103}, {133, 134, 133}, {88, 90, 89}, {105, 106, 105}, {176, 178, 177}, {188, 190, 188}, {91, 96, 95}, {228, 210, 209}, {196, 55, 44}, {199, 106, 100}, {184, 223, 246}, {181, 221, 248}, {181, 221, 247}, {181, 221, 247}, {181, 221, 247}, {181, 221, 247}, {181, 221, 247}, {181, 221, 247}},
    		{{182, 222, 248}, {182, 222, 248}, {182, 222, 248}, {182, 222, 248}, {182, 222, 248}, {182, 222, 248}, {181, 222, 248}, {191, 231, 254}, {216, 121, 112}, {204, 50, 38}, {230, 201, 198}, {238, 243, 241}, {245, 247, 244}, {212, 214, 212}, {82, 84, 83}, {97, 99, 98}, {176, 178, 178}, {187, 189, 188}, {90, 96, 95}, {224, 201, 199}, {193, 50, 39}, {197, 113, 107}, {184, 225, 248}, {182, 222, 249}, {182, 222, 248}, {182, 222, 248}, {182, 222, 248}, {182, 222, 248}, {182, 222, 248}, {182, 222, 248}},
    		{{184, 223, 249}, {184, 223, 249}, {184, 223, 249}, {184, 223, 249}, {184, 223, 249}, {184, 223, 249}, {183, 223, 249}, {189, 232, 255}, {214, 143, 138}, {200, 42, 29}, {227, 177, 171}, {174, 182, 180}, {171, 173, 172}, {200, 202, 201}, {82, 84, 83}, {101, 103, 102}, {160, 162, 163}, {171, 174, 174}, {90, 98, 98}, {218, 172, 170}, {189, 41, 31}, {195, 132, 132}, {185, 228, 253}, {184, 223, 249}, {184, 223, 249}, {184, 223, 249}, {184, 223, 249}, {184, 223, 249}, {184, 223, 249}, {184, 223, 249}},
    		{{188, 225, 251}, {188, 225, 251}, {188, 225, 251}, {188, 225, 251}, {188, 225, 251}, {188, 225, 251}, {188, 225, 251}, {188, 231, 255}, {212, 180, 182}, {198, 44, 32}, {214, 119, 111}, {184, 191, 191}, {39, 41, 40}, {44, 46, 45}, {134, 136, 137}, {168, 171, 172}, {40, 41, 41}, {39, 41, 41}, {149, 157, 158}, {207, 116, 112}, {189, 42, 33}, {193, 167, 173}, {187, 230, 255}, {188, 225, 251}, {188, 225, 251}, {188, 225, 251}, {188, 225, 251}, {188, 225, 251}, {188, 225, 251}, {188, 225, 251}},
    		{{189, 225, 250}, {189, 225, 250}, {189, 225, 250}, {189, 225, 250}, {189, 225, 250}, {189, 225, 250}, {189, 225, 250}, {188, 227, 252}, {207, 219, 230}, {203, 72, 61}, {197, 56, 44}, {224, 199, 196}, {178, 186, 187}, {151, 153, 154}, {220, 224, 225}, {224, 228, 230}, {162, 165, 167}, {158, 166, 168}, {213, 189, 190}, {187, 52, 46}, {189, 66, 60}, {191, 207, 221}, {189, 228, 253}, {189, 225, 250}, {189, 225, 250}, {189, 225, 250}, {189, 225, 250}, {189, 225, 250}, {189, 225, 250}, {189, 225, 250}},
    		{{191, 225, 250}, {191, 225, 250}, {191, 225, 250}, {191, 225, 250}, {191, 225, 250}, {191, 225, 250}, {191, 225, 250}, {190, 225, 251}, {194, 232, 253}, {204, 137, 132}, {194, 43, 31}, {199, 87, 78}, {224, 217, 217}, {229, 240, 242}, {221, 227, 229}, {220, 226, 228}, {225, 235, 240}, {220, 213, 216}, {191, 82, 78}, {182, 37, 31}, {191, 129, 129}, {190, 228, 251}, {191, 226, 251}, {191, 225, 250}, {191, 225, 250}, {191, 225, 250}, {191, 225, 250}, {191, 225, 250}, {191, 225, 250}, {191, 225, 250}},
    		{{191, 225, 250}, {191, 225, 250}, {191, 225, 250}, {191, 225, 250}, {191, 225, 250}, {191, 225, 250}, {191, 225, 250}, {191, 225, 250}, {190, 227, 253}, {196, 209, 220}, {197, 81, 72}, {189, 43, 33}, {194, 79, 72}, {209, 165, 164}, {214, 205, 207}, {213, 203, 206}, {204, 163, 162}, {187, 75, 70}, {180, 39, 33}, {186, 75, 70}, {191, 206, 219}, {191, 227, 253}, {191, 225, 250}, {191, 225, 250}, {191, 225, 250}, {191, 225, 250}, {191, 225, 250}, {191, 225, 250}, {191, 225, 250}, {191, 225, 250}},
    		{{195, 226, 252}, {195, 226, 252}, {195, 226, 252}, {195, 226, 252}, {195, 226, 252}, {195, 226, 252}, {195, 226, 252}, {195, 226, 252}, {195, 226, 252}, {194, 230, 254}, {198, 186, 192}, {193, 68, 60}, {187, 41, 33}, {186, 46, 38}, {186, 59, 53}, {185, 59, 54}, {181, 45, 39}, {179, 39, 33}, {183, 65, 59}, {192, 182, 190}, {194, 230, 255}, {195, 226, 252}, {195, 226, 252}, {195, 226, 252}, {195, 226, 252}, {195, 226, 252}, {195, 226, 252}, {195, 226, 252}, {195, 226, 252}, {195, 226, 252}},
    		{{197, 228, 251}, {197, 228, 251}, {197, 228, 251}, {197, 228, 251}, {197, 228, 251}, {197, 228, 251}, {197, 228, 251}, {197, 228, 251}, {197, 228, 251}, {197, 228, 252}, {195, 230, 252}, {196, 192, 200}, {192, 98, 94}, {183, 53, 47}, {180, 44, 39}, {180, 45, 40}, {179, 53, 47}, {186, 96, 92}, {192, 189, 197}, {195, 230, 252}, {197, 228, 252}, {197, 228, 251}, {197, 228, 251}, {197, 228, 251}, {197, 228, 251}, {197, 228, 251}, {197, 228, 251}, {197, 228, 251}, {197, 228, 251}, {197, 228, 251}},
    		{{197, 228, 249}, {197, 228, 249}, {197, 228, 249}, {197, 228, 249}, {197, 228, 249}, {197, 228, 249}, {197, 228, 249}, {197, 228, 249}, {197, 228, 249}, {197, 228, 249}, {197, 228, 249}, {196, 230, 251}, {195, 221, 236}, {194, 185, 191}, {189, 151, 152}, {183, 146, 147}, {191, 183, 189}, {193, 219, 234}, {196, 230, 252}, {197, 228, 249}, {197, 228, 249}, {197, 228, 249}, {197, 228, 249}, {197, 228, 249}, {197, 228, 249}, {197, 228, 249}, {197, 228, 249}, {197, 228, 249}, {197, 228, 249}, {197, 228, 249}},
    		{{198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 249}, {198, 229, 250}, {198, 230, 251}, {198, 233, 254}, {203, 221, 226}, {147, 173, 182}, {194, 230, 251}, {198, 230, 252}, {198, 229, 250}, {198, 229, 249}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}},
    		{{198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {199, 230, 251}, {231, 240, 242}, {165, 185, 193}, {194, 226, 247}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}},
    		{{198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {199, 230, 250}, {230, 239, 241}, {167, 187, 196}, {194, 226, 246}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}},
    		{{198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {199, 230, 250}, {230, 239, 241}, {167, 187, 196}, {194, 226, 246}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}, {198, 229, 249}},
    		{{198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {199, 230, 251}, {230, 239, 241}, {167, 187, 195}, {195, 226, 247}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}},
    		{{198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {199, 230, 251}, {230, 239, 241}, {167, 187, 195}, {194, 226, 247}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}, {198, 229, 250}}
    		};

    // Feed input into the stream
    for (int i = 0; i < 30; i++) {
        for (int j = 0; j < 30; j++) {
            for (int c = 0; c < 3; c++) {
                axi_t val;
                val.data = test_input[i][j][c];
                input_stream.write(val);
            }
        }
    }

    // Call the CNN forward function
    cnn(input_stream, output_stream);

    return 0;
}
